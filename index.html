<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spark Seneca Credit Estimator</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- html2canvas for screenshot functionality -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Custom Styles to match your site -->
    <style>
        /* Define theme from your site */
        body {
            font-family: 'Inter', sans-serif;
            background: #f8faff; /* Simplified background for embedding */
            color: #4b5563;
        }

        /* Custom styles for UI elements to match your site's theme */
        .themed-card {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 16px;
            transition: all 0.3s ease;
        }
        
        /* Primary button style from your theme */
        .btn-primary {
            background-color: #0B66FF;
            color: white;
            transition: background-color 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #0058e6;
        }
        
        /* Custom checkbox style */
        .themed-checkbox {
            appearance: none;
            background-color: #fff;
            margin: 0;
            font: inherit;
            color: currentColor;
            width: 1.15em;
            height: 1.15em;
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            transform: translateY(-0.075em);
            display: grid;
            place-content: center;
            cursor: pointer;
        }
        .themed-checkbox::before {
            content: "";
            width: 0.65em;
            height: 0.65em;
            transform: scale(0);
            transition: 120ms transform ease-in-out;
            box-shadow: inset 1em 1em #0B66FF;
            transform-origin: bottom left;
            clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
        }
        .themed-checkbox:checked::before {
            transform: scale(1);
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div id="estimator-root">
        <header class="text-center mb-12">
            <h1 class="text-4xl sm:text-5xl font-bold tracking-tight" style="color: #1a1a1a;">
                How to Use Your Credits
            </h1>
            <p class="text-lg mt-3 max-w-3xl mx-auto" style="color: #4b5563;">
                Select from our services to build a custom package and generate your estimate.
            </p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
            
            <!-- Categories Column -->
            <div id="categories-container" class="lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Category cards will be dynamically inserted here -->
            </div>

            <!-- Summary Column -->
            <div class="lg:sticky top-8">
                <div id="summary-panel" class="themed-card p-6 md:p-8">
                    <h2 class="text-2xl font-bold text-center mb-4" style="color: #1a1a1a;">Your Estimate</h2>
                    <div class="text-center mb-6">
                        <div class="text-sm uppercase tracking-wider mb-2" style="color: #4b5563;">Total Credits</div>
                        <div id="total-credits" class="text-5xl font-extrabold" style="color: #0B66FF;">0.00</div>
                    </div>
                    
                    <div id="recommendations" class="mb-6 space-y-4">
                        <!-- Recommendations will be inserted here -->
                    </div>
                    
                    <button id="download-btn" class="w-full flex items-center justify-center gap-2 font-semibold py-3 px-4 rounded-lg btn-primary disabled:opacity-50 disabled:cursor-not-allowed">
                         <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
                        Download Estimate as Image
                    </button>
                    <button id="reset-btn" class="w-full text-center text-sm text-slate-500 hover:text-slate-800 mt-4 transition-colors">Reset Selections</button>
                </div>
            </div>
        </main>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        
        const servicesData = [
            // Governance & Strategy
            { name: 'Company-Wide AI Acceptable Use Policy', credits: 25.00, displayCategory: 'Governance & Strategy' },
            { name: 'Team/Function AI Acceptable Use Policy', credits: 5.00, displayCategory: 'Governance & Strategy' },
            { name: 'AI Risk Assessment', credits: 75.00, displayCategory: 'Governance & Strategy' },
            { name: 'AI Executive Planning Session', credits: 30.00, displayCategory: 'Governance & Strategy' },
            { name: 'AI Maturity Map', credits: 5.00, displayCategory: 'Governance & Strategy' },
            { name: 'AI Fit Assessment', credits: 10.00, displayCategory: 'Governance & Strategy' },
            { name: 'Monthly ROI Review', credits: 5.00, displayCategory: 'Governance & Strategy' },
            { name: 'Key User Working Group', credits: 5.00, displayCategory: 'Governance & Strategy' },
            // Tools & Infrastructure
            { name: 'AI Tool Proof of Concept', credits: 20.00, displayCategory: 'Tools & Infrastructure' },
            { name: 'Tool Integration', credits: 25.00, displayCategory: 'Tools & Infrastructure' },
            { name: 'Tool Set-Up', credits: 10.00, displayCategory: 'Tools & Infrastructure' },
            { name: 'Tool Selection & Comparison', credits: 20.00, displayCategory: 'Tools & Infrastructure' },
            { name: 'Custom GPT', credits: 8.00, displayCategory: 'Tools & Infrastructure' },
            { name: 'GPT Refinement', credits: 2.50, displayCategory: 'Tools & Infrastructure' },
            { name: 'Prompt Management System', credits: 20.00, displayCategory: 'Tools & Infrastructure' },
            { name: 'What Tool for What? Cheatsheet', credits: 1.00, displayCategory: 'Tools & Infrastructure' },
            // Workflows & Prompting
            { name: 'AI Workflow Creation', credits: 10.00, displayCategory: 'Workflows & Prompting' },
            { name: 'Simple Workflow Rewrite', credits: 12.50, displayCategory: 'Workflows & Prompting' },
            { name: 'Complex Workflow Rewrite', credits: 25.00, displayCategory: 'Workflows & Prompting' },
            { name: 'Custom Prompts', credits: 2.00, displayCategory: 'Workflows & Prompting' },
            { name: 'Prompt Refinement', credits: 1.50, displayCategory: 'Workflows & Prompting' },
            // Training & Support
            { name: 'Business-Wide AI Fundamentals', credits: 80.00, displayCategory: 'Training & Support' },
            { name: 'Function or Technique Specific Workshop', credits: 80.00, displayCategory: 'Training & Support' },
            { name: 'Prompting Workshop', credits: 80.00, displayCategory: 'Training & Support' },
            { name: 'AMA Session (Full Company)', credits: 50.00, displayCategory: 'Training & Support' },
            { name: 'AI Tutorials', credits: 2.00, displayCategory: 'Training & Support' },
            { name: 'AI Q&A Support', credits: 1.00, displayCategory: 'Training & Support' },
            { name: '1:1 Working Session', credits: 10.00, displayCategory: 'Training & Support' },
            { name: 'AI Brainstorming Small Group', credits: 10.00, displayCategory: 'Training & Support' },
            { name: 'Recorded Walkthrough', credits: 2.00, displayCategory: 'Training & Support' },
        ];

        const creditPacks = [
            { size: 100, price: 5000 }, { size: 250, price: 11250 },
            { size: 500, price: 20000 }, { size: 1000, price: 35000 } 
        ];

        let state = { selectedServices: {} }; // E.g., { "Service Name": quantity }

        const categoriesContainer = document.getElementById('categories-container');
        const totalCreditsEl = document.getElementById('total-credits');
        const recommendationsEl = document.getElementById('recommendations');
        const downloadBtn = document.getElementById('download-btn');
        const resetBtn = document.getElementById('reset-btn');
        const estimatorRoot = document.getElementById('estimator-root');

        const categories = [...new Set(servicesData.map(s => s.displayCategory))];

        function render() {
            renderCategories();
            const totalCredits = calculateTotalCredits();
            const recommended = calculateRecommendedPacks(totalCredits);
            
            totalCreditsEl.textContent = totalCredits.toFixed(2);
            renderRecommendations(recommended, totalCredits);
            downloadBtn.disabled = totalCredits === 0;
        }

        function renderCategories() {
            categoriesContainer.innerHTML = '';
            categories.forEach(category => {
                const categoryServices = servicesData.filter(s => s.displayCategory === category);
                const categoryCard = document.createElement('div');
                categoryCard.className = 'themed-card p-6';
                
                const servicesHTML = categoryServices.map(service => {
                    const isChecked = state.selectedServices[service.name] > 0;
                    const quantity = state.selectedServices[service.name] || 1;
                    return `
                        <div class="service-item flex items-center gap-3 py-2 border-b border-slate-100 last:border-b-0">
                            <input type="checkbox" id="cb-${service.name.replace(/\s/g, '-')}" data-name="${service.name}" class="themed-checkbox flex-shrink-0" ${isChecked ? 'checked' : ''}>
                            <label for="cb-${service.name.replace(/\s/g, '-')}" class="flex-grow cursor-pointer">
                                <span class="font-medium text-slate-800">${service.name}</span>
                                <span class="text-xs text-slate-500 block">${service.credits} credits</span>
                            </label>
                            <input type="number" min="1" value="${quantity}" data-name="${service.name}" class="quantity-input w-16 p-1.5 bg-slate-100 border border-slate-200 rounded-md text-center text-sm ${isChecked ? '' : 'hidden'}">
                        </div>
                    `;
                }).join('');

                categoryCard.innerHTML = `
                    <h3 class="text-xl font-bold text-center mb-4" style="color:#0B66FF;">${category}</h3>
                    <div class="space-y-1">${servicesHTML}</div>
                `;
                categoriesContainer.appendChild(categoryCard);
            });
        }

        function renderRecommendations(recommended, totalCredits) {
            if (totalCredits === 0) {
                recommendationsEl.innerHTML = `
                    <div class="text-center py-6 text-slate-500">
                        <p class="text-sm">Your recommended package and cost will appear here.</p>
                    </div>`;
                return;
            }
            recommendationsEl.innerHTML = `
                <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <div class="font-semibold text-blue-800 mb-2 text-sm">Recommended Package</div>
                    <div class="space-y-1.5">
                        ${recommended.packs.map(pack => `
                            <div class="flex justify-between items-center text-sm">
                                <span class="font-bold text-slate-900">${pack.count}x ${pack.size.toLocaleString()} Credit Pack</span>
                                <span class="font-semibold text-slate-700">$${(pack.price * pack.count).toLocaleString()}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
                <div class="bg-green-50 border-2 border-green-200 p-4 rounded-lg text-center mt-4">
                    <div class="text-sm text-green-800 mb-1">Total Investment</div>
                    <div class="text-3xl font-extrabold text-green-700">$${recommended.totalCost.toLocaleString()}</div>
                </div>`;
        }

        function calculateTotalCredits() {
            return Object.entries(state.selectedServices).reduce((total, [serviceName, quantity]) => {
                const service = servicesData.find(s => s.name === serviceName);
                return total + (service ? service.credits * quantity : 0);
            }, 0);
        }

        function calculateRecommendedPacks(totalCredits) {
            if (totalCredits <= 0) return { packs: [], totalCost: 0 };
            let bestCombination = [];
            let lowestCost = Infinity;
            const maxPacks = Math.ceil(totalCredits / creditPacks[0].size) + 1;

            function find(target, currentPacks, cost) {
                if (cost >= lowestCost) return;
                if (target <= 0) {
                    lowestCost = cost;
                    bestCombination = currentPacks;
                    return;
                }
                for (let i = creditPacks.length - 1; i >= 0; i--) {
                    const pack = creditPacks[i];
                    find(target - pack.size, [...currentPacks, pack], cost + pack.price);
                }
            }
            find(totalCredits, [], 0);

            const packCounts = bestCombination.reduce((acc, pack) => {
                acc[pack.size] = (acc[pack.size] || 0) + 1;
                return acc;
            }, {});
            
            const finalPacks = Object.entries(packCounts).map(([size, count]) => {
                const packDetails = creditPacks.find(p => p.size == size);
                return { ...packDetails, count };
            }).sort((a,b) => b.size - a.size);

            return { packs: finalPacks, totalCost: lowestCost };
        }
        
        function handleSelectionChange(e) {
            const target = e.target;
            const serviceName = target.dataset.name;
            const serviceItem = target.closest('.service-item');
            if (!serviceName || !serviceItem) return;

            const quantityInput = serviceItem.querySelector('.quantity-input');

            if (target.type === 'checkbox') {
                if (target.checked) {
                    state.selectedServices[serviceName] = parseInt(quantityInput.value) || 1;
                    quantityInput.classList.remove('hidden');
                } else {
                    delete state.selectedServices[serviceName];
                    quantityInput.classList.add('hidden');
                }
            } else if (target.type === 'number') {
                if (state.selectedServices[serviceName]) {
                    state.selectedServices[serviceName] = parseInt(target.value) || 1;
                }
            }
            render();
        }
        
        function handleScreenshot() {
            const btn = this;
            const originalText = btn.innerHTML;
            btn.innerHTML = 'Generating...';
            btn.disabled = true;

            html2canvas(estimatorRoot, {
                backgroundColor: '#f8faff', // Match body background
                scale: 1.5 // Higher resolution
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'spark-seneca-estimate.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
                btn.innerHTML = originalText;
                btn.disabled = false;
            });
        }
        
        function handleReset() {
            state.selectedServices = {};
            render();
        }

        categoriesContainer.addEventListener('change', handleSelectionChange);
        categoriesContainer.addEventListener('input', handleSelectionChange);
        downloadBtn.addEventListener('click', handleScreenshot);
        resetBtn.addEventListener('click', handleReset);
        
        render();
    });
    </script>
</body>
</html>
